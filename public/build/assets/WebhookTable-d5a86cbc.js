import{T as x,r as c,c as d,h as l,f as n,u as a,k as z,F as f,o as u,g as _,t as i,d as g,e as k,a as e,b as D,n as h,j as C}from"./app-d65cc6ad.js";import"./_baseGetTag-670fd5c8.js";import{_ as H}from"./AlertModal-e893babf.js";import{u as q}from"./useAlertModal-88d36c97.js";/* empty css              */import{_ as G}from"./FormCheckbox-eed183e1.js";import{_ as I}from"./FormInput-cef6e779.js";import{_ as B}from"./Modal-065093c0.js";import{_ as J}from"./Table-b881dd59.js";import{T as K,a as P,_ as T}from"./TableHeaderRowItem-3d0671a2.js";import{T as Q,_ as V,a as X}from"./TableBodyRowItem-e958b373.js";import{_ as Y}from"./Dropdown-7a5f5867.js";import{_ as ee,a as M}from"./DropdownItem-fbe6bd1f.js";import"./transition-ff0cbc41.js";import"./hidden-7933a274.js";import"./use-text-value-16cd3154.js";import"./micro-task-89dcd6af.js";import"./Pagination-bcad5152.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./use-tree-walker-78033913.js";const te={class:"flex"},se={class:"text-left mr-3 text-sm relative w-[10em] truncate"},oe={class:"py-1 px-2 bg-gray-50 rounded-[5px] border border-dashed w-[20em] truncate text-xs capitalize"},le={class:"flex items-center"},ne=["onClick"],re=e("button",{class:"inline-flex w-full justify-center rounded-md text-sm font-medium text-black hover:bg-opacity-30 focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75"},[e("span",{class:"hover:bg-[#F6F7F9] hover:rounded-full w-[fit-content] p-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M12 16a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2m0-6a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2m0-6a2 2 0 0 1 2 2a2 2 0 0 1-2 2a2 2 0 0 1-2-2a2 2 0 0 1 2-2Z"})])])],-1),ae={class:"mt-5 grid grid-cols-1 gap-x-6"},ie={class:"mt-4 text-sm"},ue={class:"mt-4 flex"},de=["disabled"],ce={key:0,xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24"},me=e("path",{fill:"currentColor",d:"M12 2A10 10 0 1 0 22 12A10 10 0 0 0 12 2Zm0 18a8 8 0 1 1 8-8A8 8 0 0 1 12 20Z",opacity:".5"},null,-1),fe=e("path",{fill:"currentColor",d:"M20 12h2A10 10 0 0 0 12 2V4A8 8 0 0 1 20 12Z"},[e("animateTransform",{attributeName:"transform",dur:"1s",from:"0 12 12",repeatCount:"indefinite",to:"360 12 12",type:"rotate"})],-1),pe=[me,fe],be={key:1},ve={class:"mt-5 grid grid-cols-1 gap-x-6"},_e=e("h4",{class:"mb-2"},"Webhook URL",-1),ge={class:"text-sm bg-slate-100 py-1 rounded-md px-2"},he={class:"mt-4"},we=e("h4",{class:"mb-2"},"Events",-1),ye={class:"flex items-center justify-between border-b py-1 text-sm"},$e={class:"capitalize"},xe=["onClick"],ke={class:"grid gap-x-6 sm:grid-cols-6"},Ce={class:"mt-4 flex"},Ie={__name:"WebhookTable",props:{rows:{type:Object,required:!0},events:{type:Object}},emits:["delete"],setup(w,{emit:Te}){const A=w,{isOpenAlert:y,openAlert:E,confirmAlert:N}=q(),S=x({test:null});c(null),c(null);const p=c(!1),$=c(!1),O=c(null),R=t=>{S.delete("/developer-tools/webhooks/"+t)},U=t=>t===A.rows.data.length-1,r=x({url:null,events:[]}),F=t=>{r.url=t.url,r.events=t.events.map(o=>o.event),p.value=!0},L=t=>{r.url=t.url,r.events=t.events.map(o=>o.event),$.value=!0},j=x({url:null}),b=c(null),W=(t,o)=>{j.url=t,b.value=o,j.post(`/webhooks/trigger/${o}/test`,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{b.value=null},onError:()=>{b.value=null}})},Z=async()=>{r.post("/developer-tools/webhooks/"+O.value,{preserveScroll:!0,preserveState:!1,onSuccess:()=>{p.value=!1}})};return(t,o)=>(u(),d(f,null,[l(J,{rows:w.rows},{default:n(()=>[l(K,null,{default:n(()=>[l(P,null,{default:n(()=>[l(T,{position:"first"},{default:n(()=>[_(i(t.$t("Notification URL")),1)]),_:1}),l(T,null,{default:n(()=>[_(i(t.$t("Events")),1)]),_:1}),l(T,{position:"last"})]),_:1})]),_:1}),l(Q,null,{default:n(()=>[(u(!0),d(f,null,g(w.rows.data,(s,m)=>(u(),k(X,{key:m,class:h(U(m)?"":"border-b")},{default:n(()=>[l(V,{position:"first"},{default:n(()=>[e("div",te,[e("div",se,[e("span",null,i(s.url),1)])])]),_:2},1024),l(V,{class:"hidden sm:table-cell"},{default:n(()=>[e("div",oe,[(u(!0),d(f,null,g(s.events,v=>(u(),d("span",null,i(v.event)+", ",1))),256))])]),_:2},1024),l(V,{position:"last"},{default:n(()=>[e("div",le,[e("button",{onClick:v=>L(s),class:"bg-slate-100 border rounded-md py-1 px-4 h-[fit-content]"},"Test",8,ne),s.role!="admin"?(u(),k(Y,{key:0,align:"right",class:"mt-2"},{items:n(()=>[l(ee,null,{default:n(()=>[l(M,{as:"button",onClick:v=>{F(s),O.value=s.uuid}},{default:n(()=>[_(i(t.$t("View/edit")),1)]),_:2},1032,["onClick"]),l(M,{as:"button",onClick:v=>a(E)(s.uuid)},{default:n(()=>[_(i(t.$t("Delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),default:n(()=>[re]),_:2},1024)):D("",!0)])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})]),_:1},8,["rows"]),l(B,{label:t.$t("Edit/View Webhook"),isOpen:p.value},{default:n(()=>[e("div",ae,[e("form",{onSubmit:o[3]||(o[3]=C(s=>Z(),["prevent"])),class:"grid gap-x-6 sm:grid-cols-6"},[l(I,{modelValue:a(r).url,"onUpdate:modelValue":o[0]||(o[0]=s=>a(r).url=s),error:a(r).errors.url,name:t.$t("URL"),type:"text",class:h("sm:col-span-6")},null,8,["modelValue","error","name"]),e("h4",ie,i(t.$t("Events")),1),(u(!0),d(f,null,g(A.events,s=>(u(),k(G,{key:s,modelValue:a(r).events,"onUpdate:modelValue":o[1]||(o[1]=m=>a(r).events=m),error:a(r).errors.events,name:t.$t(s),label:t.$t(s),value:s,type:"text",class:h("sm:col-span-6")},null,8,["modelValue","error","name","label","value"]))),128)),e("div",ue,[e("button",{type:"button",onClick:o[2]||(o[2]=C(s=>p.value=!1,["self"])),class:"inline-flex justify-center rounded-md border border-transparent bg-slate-50 px-4 py-2 text-sm text-slate-500 hover:bg-slate-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 mr-4"},i(t.$t("Cancel")),1),e("button",{class:h(["inline-flex justify-center rounded-md border border-transparent bg-primary px-4 py-2 text-sm text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",{"opacity-50":a(S).processing}]),disabled:a(r).processing},[a(r).processing?(u(),d("svg",ce,pe)):(u(),d("span",be,i(t.$t("Save")),1))],10,de)])],32)])]),_:1},8,["label","isOpen"]),l(B,{label:t.$t("Test Webhook Notifications"),isOpen:$.value},{default:n(()=>[e("div",ve,[e("div",null,[_e,e("h5",ge,i(a(r).url),1)]),e("div",he,[we,(u(!0),d(f,null,g(a(r).events,s=>(u(),d("div",null,[e("div",ye,[e("div",null,[e("span",$e,i(s),1)]),e("div",null,[e("button",{onClick:m=>W(a(r).url,s),class:"bg-slate-100 border rounded-md py-1 px-4 h-[fit-content]"},i(b.value===s?"Sending...":"Test"),9,xe)])])]))),256))]),e("div",ke,[e("div",Ce,[e("button",{type:"button",onClick:o[4]||(o[4]=C(s=>$.value=!1,["self"])),class:"inline-flex justify-center rounded-md border border-transparent bg-slate-50 px-4 py-2 text-sm text-slate-500 hover:bg-slate-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 mr-4"},i(t.$t("Cancel")),1)])])])]),_:1},8,["label","isOpen"]),l(H,{modelValue:a(y),"onUpdate:modelValue":o[5]||(o[5]=s=>z(y)?y.value=s:null),onConfirm:o[6]||(o[6]=()=>a(N)(R)),label:t.$t("Delete row"),description:t.$t("Are you sure you want to delete this row? This action can not be undone")},null,8,["modelValue","label","description"])],64))}};export{Ie as default};
